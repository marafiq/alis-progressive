@model Alis.Progressive.SandboxApp.Models.SimpleConditionalViewModel
@{
    ViewData["Title"] = "Sample 12: Simple Conditional Validation";
}
<h1>Sample 12: Simple Conditional Validation</h1>
    <p><strong>Concept:</strong> Phone number is required ONLY when "Accept Terms" is checked. The form will NOT submit if validation fails on the client-side.</p>

    <form asp-action="Sample12" asp-controller="Samples" hx-post hx-target="#result" hx-swap="innerHTML" hx-ext="framework" hx-validate="true"
          x-data="{ acceptTerms: false }">
        <div class="form-group">
            <label asp-for="Email"></label>
            <input asp-for="Email" type="email" />
            <span asp-validation-for="Email" class="field-validation-error"></span>
        </div>
        
        <div class="form-group">
            <label>
                <input type="checkbox" id="AcceptTerms" name="AcceptTerms" value="true" 
                       x-model="acceptTerms" />
                Accept Terms and Conditions
            </label>
            <span asp-validation-for="AcceptTerms" class="field-validation-error"></span>
        </div>
        
        <div class="form-group" id="phoneGroup" x-show="acceptTerms">
            <label asp-for="PhoneNumber"></label>
            <input asp-for="PhoneNumber" type="tel" id="PhoneNumber" name="PhoneNumber" 
                   x-validate-when="acceptTerms" />
            <span asp-validation-for="PhoneNumber" class="field-validation-error"></span>
            <small style="color: #666;">This field is validated only when checkbox is checked</small>
        </div>
        
        <button type="submit">Submit</button>
        <div id="result"></div>
    </form>

    <div style="margin-top: 2rem; padding: 1.5rem; background: #e7f3ff; border-radius: 8px; border-left: 4px solid #007bff;">
        <h4>âœ… How Client-Side Conditional Validation Works:</h4>
        <ol style="line-height: 1.8;">
            <li><strong>Checkbox Unchecked:</strong> Phone field is hidden and NOT required
                <ul><li>â†’ Form will submit successfully even with empty phone</li></ul>
            </li>
            <li><strong>Checkbox Checked:</strong> Phone field becomes visible and REQUIRED
                <ul><li>â†’ Validation error appears on blur if empty or invalid</li></ul>
            </li>
            <li><strong>Client-Side Prevention:</strong> If validation fails, <strong>form will NOT submit</strong>
                <ul><li>â†’ No server request is made (0 POST requests)</li></ul>
            </li>
            <li><strong>Server-Side Fallback:</strong> RequiredIf attribute validates on server too
                <ul><li>â†’ Returns 400 with Problem Details if validation fails</li></ul>
            </li>
        </ol>
        
        <h4 style="margin-top: 1rem;">ğŸ§ª Test Scenarios:</h4>
        <ol style="line-height: 1.8;">
            <li>âœ… Fill email, leave checkbox unchecked â†’ Submit â†’ <strong>Should succeed</strong></li>
            <li>âŒ Fill email, check checkbox, leave phone empty â†’ Submit â†’ <strong>Should be blocked client-side</strong></li>
            <li>âŒ Fill email, check checkbox, type invalid phone (e.g., "123") â†’ Submit â†’ <strong>Should be blocked client-side</strong></li>
            <li>âœ… Fill email, check checkbox, type valid phone (e.g., "555-123-4567") â†’ Submit â†’ <strong>Should succeed</strong></li>
        </ol>
        
        <div style="margin-top: 1rem; padding: 1rem; background: #fff3cd; border-radius: 4px;">
            <strong>ğŸ’¡ Key Point:</strong> When validation fails on the client-side, the form <strong>will NOT submit</strong>. 
            You won't see any server response - the browser blocks the submission before it reaches the server.
        </div>
    </div>